<ng-container
  *ngIf="!loadingVendors() && !loadingLocations(); else loadingTemplate"
>
  <div class="form-container">
    <mat-card class="form-card">
      <mat-card-header>
        <mat-card-title>{{ titleLabel }}</mat-card-title>
      </mat-card-header>

      <form [formGroup]="form()" class="form-layout" (ngSubmit)="onSubmit()">
        <!-- Row 1: Vendor or Client + Client Location -->
        <div class="form-row">
          <div class="form-field">
            <lib-select-field
              label="Vendor or Client"
              formControlName="vendorOrClient"
              [options]="vendorsAndClients()"
              [required]="true"
            ></lib-select-field>
          </div>

          <div class="form-field">
            <lib-select-field
              label="Client Location"
              formControlName="clientLocation"
              [options]="greencoreLocations()"
              [required]="true"
            ></lib-select-field>
          </div>
        </div>

        <!-- Row 2: Quantity + Delivery Date -->
        <div class="form-row">
          <div class="form-field">
            <lib-input-field
              label="Quantity"
              placeholder="Enter quantity"
              formControlName="quantity"
              type="number"
              [required]="true"
            ></lib-input-field>
          </div>

          <div class="form-field">
            <lib-date-picker-field
              label="Delivery Date"
              placeholder="Select delivery date"
              formControlName="deliveryDate"
              restriction="future"
            ></lib-date-picker-field>
          </div>
        </div>

        <!-- Description -->
        <div class="form-field form-full-width">
          <lib-input-field
            label="Description"
            placeholder="Enter description"
            formControlName="description"
            type="text"
          ></lib-input-field>
        </div>

        <!-- Actions -->
        <div class="form-actions">
          <button
            mat-raised-button
            color="primary"
            type="submit"
            [disabled]="form().invalid || submitting()"
          >
            <mat-progress-spinner
              *ngIf="submitting()"
              mode="indeterminate"
              diameter="20"
              color="accent"
            ></mat-progress-spinner>
            <span *ngIf="!submitting()">Save Work Order</span>
            <span *ngIf="submitting()">Submitting...</span>
          </button>
        </div>
      </form>
    </mat-card>
  </div>
</ng-container>

<ng-template #loadingTemplate>
  <div class="loader-container">
    <lib-ui-material-loader></lib-ui-material-loader>
  </div>
</ng-template>
